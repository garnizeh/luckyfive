// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: configs.sql

package configs

import (
	"context"
	"database/sql"
)

const createConfig = `-- name: CreateConfig :one
INSERT INTO configs (
    name, description, recipe_json, tags, is_default, mode, created_by
) VALUES (?, ?, ?, ?, ?, ?, ?)
RETURNING id, name, description, recipe_json, tags, is_default, mode, created_at, updated_at, created_by, times_used, last_used_at
`

type CreateConfigParams struct {
	Name        string         `json:"name"`
	Description sql.NullString `json:"description"`
	RecipeJson  string         `json:"recipe_json"`
	Tags        sql.NullString `json:"tags"`
	IsDefault   sql.NullInt64  `json:"is_default"`
	Mode        string         `json:"mode"`
	CreatedBy   sql.NullString `json:"created_by"`
}

func (q *Queries) CreateConfig(ctx context.Context, arg CreateConfigParams) (Config, error) {
	row := q.db.QueryRowContext(ctx, createConfig,
		arg.Name,
		arg.Description,
		arg.RecipeJson,
		arg.Tags,
		arg.IsDefault,
		arg.Mode,
		arg.CreatedBy,
	)
	var i Config
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.RecipeJson,
		&i.Tags,
		&i.IsDefault,
		&i.Mode,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.CreatedBy,
		&i.TimesUsed,
		&i.LastUsedAt,
	)
	return i, err
}

const deleteConfig = `-- name: DeleteConfig :exec
DELETE FROM configs
WHERE id = ?
`

func (q *Queries) DeleteConfig(ctx context.Context, id int64) error {
	_, err := q.db.ExecContext(ctx, deleteConfig, id)
	return err
}

const getConfig = `-- name: GetConfig :one
SELECT id, name, description, recipe_json, tags, is_default, mode, created_at, updated_at, created_by, times_used, last_used_at FROM configs
WHERE id = ?
LIMIT 1
`

func (q *Queries) GetConfig(ctx context.Context, id int64) (Config, error) {
	row := q.db.QueryRowContext(ctx, getConfig, id)
	var i Config
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.RecipeJson,
		&i.Tags,
		&i.IsDefault,
		&i.Mode,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.CreatedBy,
		&i.TimesUsed,
		&i.LastUsedAt,
	)
	return i, err
}

const getConfigByName = `-- name: GetConfigByName :one
SELECT id, name, description, recipe_json, tags, is_default, mode, created_at, updated_at, created_by, times_used, last_used_at FROM configs
WHERE name = ?
LIMIT 1
`

func (q *Queries) GetConfigByName(ctx context.Context, name string) (Config, error) {
	row := q.db.QueryRowContext(ctx, getConfigByName, name)
	var i Config
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.RecipeJson,
		&i.Tags,
		&i.IsDefault,
		&i.Mode,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.CreatedBy,
		&i.TimesUsed,
		&i.LastUsedAt,
	)
	return i, err
}

const getDefaultConfig = `-- name: GetDefaultConfig :one
SELECT id, name, description, recipe_json, tags, is_default, mode, created_at, updated_at, created_by, times_used, last_used_at FROM configs
WHERE is_default = 1 AND mode = ?
LIMIT 1
`

func (q *Queries) GetDefaultConfig(ctx context.Context, mode string) (Config, error) {
	row := q.db.QueryRowContext(ctx, getDefaultConfig, mode)
	var i Config
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.Description,
		&i.RecipeJson,
		&i.Tags,
		&i.IsDefault,
		&i.Mode,
		&i.CreatedAt,
		&i.UpdatedAt,
		&i.CreatedBy,
		&i.TimesUsed,
		&i.LastUsedAt,
	)
	return i, err
}

const getPreset = `-- name: GetPreset :one
SELECT id, name, display_name, description, recipe_json, risk_level, is_active, sort_order FROM config_presets
WHERE name = ?
LIMIT 1
`

func (q *Queries) GetPreset(ctx context.Context, name string) (ConfigPreset, error) {
	row := q.db.QueryRowContext(ctx, getPreset, name)
	var i ConfigPreset
	err := row.Scan(
		&i.ID,
		&i.Name,
		&i.DisplayName,
		&i.Description,
		&i.RecipeJson,
		&i.RiskLevel,
		&i.IsActive,
		&i.SortOrder,
	)
	return i, err
}

const incrementConfigUsage = `-- name: IncrementConfigUsage :exec
UPDATE configs
SET times_used = times_used + 1,
    last_used_at = CURRENT_TIMESTAMP
WHERE id = ?
`

func (q *Queries) IncrementConfigUsage(ctx context.Context, id int64) error {
	_, err := q.db.ExecContext(ctx, incrementConfigUsage, id)
	return err
}

const listConfigs = `-- name: ListConfigs :many
SELECT id, name, description, recipe_json, tags, is_default, mode, created_at, updated_at, created_by, times_used, last_used_at FROM configs
ORDER BY name ASC
LIMIT ? OFFSET ?
`

type ListConfigsParams struct {
	Limit  int64 `json:"limit"`
	Offset int64 `json:"offset"`
}

func (q *Queries) ListConfigs(ctx context.Context, arg ListConfigsParams) ([]Config, error) {
	rows, err := q.db.QueryContext(ctx, listConfigs, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Config
	for rows.Next() {
		var i Config
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Description,
			&i.RecipeJson,
			&i.Tags,
			&i.IsDefault,
			&i.Mode,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.CreatedBy,
			&i.TimesUsed,
			&i.LastUsedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listConfigsByMode = `-- name: ListConfigsByMode :many
SELECT id, name, description, recipe_json, tags, is_default, mode, created_at, updated_at, created_by, times_used, last_used_at FROM configs
WHERE mode = ?
ORDER BY times_used DESC, name ASC
LIMIT ? OFFSET ?
`

type ListConfigsByModeParams struct {
	Mode   string `json:"mode"`
	Limit  int64  `json:"limit"`
	Offset int64  `json:"offset"`
}

func (q *Queries) ListConfigsByMode(ctx context.Context, arg ListConfigsByModeParams) ([]Config, error) {
	rows, err := q.db.QueryContext(ctx, listConfigsByMode, arg.Mode, arg.Limit, arg.Offset)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []Config
	for rows.Next() {
		var i Config
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.Description,
			&i.RecipeJson,
			&i.Tags,
			&i.IsDefault,
			&i.Mode,
			&i.CreatedAt,
			&i.UpdatedAt,
			&i.CreatedBy,
			&i.TimesUsed,
			&i.LastUsedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const listPresets = `-- name: ListPresets :many
SELECT id, name, display_name, description, recipe_json, risk_level, is_active, sort_order FROM config_presets
WHERE is_active = 1
ORDER BY sort_order ASC
`

func (q *Queries) ListPresets(ctx context.Context) ([]ConfigPreset, error) {
	rows, err := q.db.QueryContext(ctx, listPresets)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []ConfigPreset
	for rows.Next() {
		var i ConfigPreset
		if err := rows.Scan(
			&i.ID,
			&i.Name,
			&i.DisplayName,
			&i.Description,
			&i.RecipeJson,
			&i.RiskLevel,
			&i.IsActive,
			&i.SortOrder,
		); err != nil {
			return nil, err
		}
		items = append(items, i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const setDefaultConfig = `-- name: SetDefaultConfig :exec
UPDATE configs
SET is_default = CASE WHEN id = ? THEN 1 ELSE 0 END
WHERE mode = ?
`

type SetDefaultConfigParams struct {
	ID   int64  `json:"id"`
	Mode string `json:"mode"`
}

func (q *Queries) SetDefaultConfig(ctx context.Context, arg SetDefaultConfigParams) error {
	_, err := q.db.ExecContext(ctx, setDefaultConfig, arg.ID, arg.Mode)
	return err
}

const updateConfig = `-- name: UpdateConfig :exec
UPDATE configs
SET description = ?,
    recipe_json = ?,
    tags = ?,
    updated_at = CURRENT_TIMESTAMP
WHERE id = ?
`

type UpdateConfigParams struct {
	Description sql.NullString `json:"description"`
	RecipeJson  string         `json:"recipe_json"`
	Tags        sql.NullString `json:"tags"`
	ID          int64          `json:"id"`
}

func (q *Queries) UpdateConfig(ctx context.Context, arg UpdateConfigParams) error {
	_, err := q.db.ExecContext(ctx, updateConfig,
		arg.Description,
		arg.RecipeJson,
		arg.Tags,
		arg.ID,
	)
	return err
}
